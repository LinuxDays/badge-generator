<!doctype html>
<html>
<head>
<meta charset="utf-8"> 
<title>badge generator</title>
<script src="jquery.js"></script>
<style>
body {
	margin: 0px;
}
div#badges {
}
div.badge {
	margin: 5px;
}
svg.svg-stitek {
	border: 1px dashed #777;
	float: left;
	margin: 0px;
	font-family: Ubuntu;
}
text {
	dominant-baseline: middle;
}
.nadpis {
	font-size: 180px;
}
.prednasejici {
	font-size: 100px;
	dominant-baseline: alphabetical;
	fill: #fff;
}
.prednasejicipod {
	fill: #222;
	z-index: 5;
}
.role {
	font-size: 80px;
	fill: #444;
}
.hody {
	font-size: 70px;
	fill: #444;
}
.twitter {
	font-size: 40px;
	}
</style>
</head>
<body>
<div id="badges">
</div>
<script>
$(document).ready(function () {
	/* load badge file */
	var file = '';


	/* generate users */
	/* 93 x 59 */
	$.getJSON('users.json', function (data) {
		$.each(data.users, function (key, value) {
			jmeno = value.jmeno
			role = value.role
			if (typeof(value.twitter) == 'string') {
				twitter = '@' + value.twitter;
			} else {
				twitter = '';
			}

			role_move = -200;
			role_class = ''
			if (jmeno == 'Petr Hodač') {
				role_move = -350;
				role_class=' hody';
			}
				

			$('div#badges').append('<div class="badge" id="user-' + key + '\">' + jmeno + '</div>');
badge = '<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svg-stitek" width="90mm" height="57mm" viewBox="0 0 590 930"> \
<!-- <text x="295" y="150" text-anchor="middle" class="nadpis">LinuxDays 2014</text> -->\
<rect y="300" x="-500" width="5000" height="250" class="prednasejicipod"/> \
<text x="250" y="435" text-anchor="middle" class="prednasejici">'+jmeno+'</text> \
<text x="'+role_move+'" y="750" text-anchor="left" class="role'+role_class+'">'+role+'</text> \
<image x="-400" y="-100" width="1400" height="500" xlink:href="logo-if.svg" class="logo"/> \
<image x="0" y="700" width="800" height="800" xlink:href="tux.svg" class="tux" transform="rotate(-40)"/> \
</svg>';
			$('div#user-'+key).html(badge);

			$('div#user-'+key+' text.prednasejici').each(function (key, el) {
				/* vypočítat parametry */
				width_final = 910;
				height_final = 300;
				x_base = 250;
				y_base = 450;
				width_base = el.getBBox().width;
				height_base = el.getBBox().height;
				ratio = Math.min(width_final/width_base, height_final/height_base, 1.5);
				/* zvětšit */
				$(el).attr('transform', 'translate('+(-x_base * (ratio - 1))+', '+(-y_base * (ratio - 1))+') scale('+ratio+')');
			});

		});
	});
});
</script>
</html>
